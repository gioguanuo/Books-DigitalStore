<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libreria Digitale</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #764ba2;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover, .nav-links a.active {
            color: #764ba2;
        }

        main {
            margin-top: 80px;
            min-height: calc(100vh - 80px);
            padding: 2rem 0;
        }

        .page {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .page.active {
            display: block;
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #764ba2;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2rem;
            color: #666;
        }

        .book-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .book-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .book-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .book-info {
            padding: 1rem;
        }

        .book-info h3 {
            margin-bottom: 0.5rem;
            color: #333;
        }

        .book-info p {
            color: #666;
            font-size: 0.9rem;
        }

        .api-section {
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #764ba2;
        }

        .api-endpoint {
            background: #fff;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            border: 1px solid #ddd;
            font-family: 'Courier New', monospace;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .api-endpoint:hover {
            background: #f0f0f0;
        }

        .json-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            margin: 1rem 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .contact-form {
            max-width: 600px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: transform 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 2rem;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            position: relative;
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 1rem;
            top: 0.5rem;
        }

        .close:hover {
            color: black;
        }

        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                gap: 1rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .book-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
	<script defer src="https://challenges.cloudflare.com/turnstile/v0/api.js"></script>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">üìö Libreria Digitale</div>
            <ul class="nav-links">
                <li><a href="#" onclick="showPage('home')" class="active">Home</a></li>
                <li><a href="#" onclick="showPage('books')">Libri</a></li>
                <li><a href="#" onclick="showPage('api')">API</a></li>
                <li><a href="#" onclick="showPage('stats')">Statistiche</a></li>
                <li><a href="#" onclick="showPage('contact')">Contatti</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <!-- HOME PAGE -->
        <div id="home" class="page active">
            <div class="hero">
                <h1>Benvenuto nella Libreria Digitale</h1>
                <p>Scopri migliaia di libri e accedi alle nostre API gratuite</p>
                <button class="btn" onclick="showPage('books')">Esplora i Libri</button>
            </div>
            <!-- Turnstile widget in home -->
			<!-- in produzione: sostituisci con la tua Site key -->
			<div style="margin-top:1rem">
			  <div class="cf-turnstile"
				   data-sitekey="0x4AAAAAABq1gQOX3nSzuwgm" 
				   data-theme="auto"
				   data-action="homepage"
				   data-callback="onTurnstileHomeSolved">
			  </div>
			</div>
			<small id="homeVerifyMsg" style="display:block; margin-top:.5rem; color:#666">
			 Verifica anti-bot in corso‚Ä¶
			</small>
			
            <div class="book-grid">
                <div class="book-card" onclick="openBookModal('Il Nome della Rosa')">
                    <div class="book-image">üåπ Il Nome della Rosa</div>
                    <div class="book-info">
                        <h3>Il Nome della Rosa</h3>
                        <p>Umberto Eco - Romanzo storico ambientato in un monastero medievale</p>
                    </div>
                </div>
                <div class="book-card" onclick="openBookModal('1984')">
                    <div class="book-image">üëÅÔ∏è 1984</div>
                    <div class="book-info">
                        <h3>1984</h3>
                        <p>George Orwell - Distopia futuristica sul controllo totalitario</p>
                    </div>
                </div>
                <div class="book-card" onclick="openBookModal('Il Piccolo Principe')">
                    <div class="book-image">üëë Il Piccolo Principe</div>
                    <div class="book-info">
                        <h3>Il Piccolo Principe</h3>
                        <p>Antoine de Saint-Exup√©ry - Racconto poetico per tutte le et√†</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- BOOKS PAGE -->
        <div id="books" class="page">
            <h2>Catalogo Libri</h2>
            <div class="book-grid" id="allBooks">
                <!-- I libri verranno caricati dinamicamente -->
            </div>
        </div>

        <!-- API PAGE -->
        <div id="api" class="page">
            <h2>API Endpoints</h2>
            <p>Clicca sugli endpoint per visualizzare i dati JSON:</p>
            
            <div class="api-section">
                <h3>üìö Libri</h3>
                <div class="api-endpoint" onclick="loadApiData('books')">
                    GET /api/books - Lista tutti i libri
                </div>
                <div class="api-endpoint" onclick="loadApiData('book', 1)">
                    GET /api/books/1 - Dettagli libro specifico
                </div>
                <div class="api-endpoint" onclick="loadApiData('book', 2)">
                    GET /api/books/2 - Dettagli "1984"
                </div>
            </div>

            <div class="api-section">
                <h3>üë• Autori</h3>
                <div class="api-endpoint" onclick="loadApiData('authors')">
                    GET /api/authors - Lista tutti gli autori
                </div>
                <div class="api-endpoint" onclick="loadApiData('author', 1)">
                    GET /api/authors/1 - Dettagli autore specifico
                </div>
                <div class="api-endpoint" onclick="loadApiData('author', 5)">
                    GET /api/authors/5 - Dettagli "J.R.R. Tolkien"
                </div>
            </div>

            <div class="api-section">
                <h3>üìä Statistiche & Dati</h3>
                <div class="api-endpoint" onclick="loadApiData('stats')">
                    GET /api/stats - Statistiche generali
                </div>
                <div class="api-endpoint" onclick="loadApiData('detailed-stats')">
                    GET /api/detailed-stats - Statistiche dettagliate
                </div>
                <div class="api-endpoint" onclick="loadApiData('categories')">
                    GET /api/categories - Categorie disponibili
                </div>
                <div class="api-endpoint" onclick="loadApiData('contact-info')">
                    GET /api/contact-info - Informazioni di contatto
                </div>
            </div>

            <div style="background: #e3f2fd; padding: 1.5rem; border-radius: 10px; margin: 2rem 0; border-left: 4px solid #2196f3;">
                <h4>üöÄ Come testare le API esternamente:</h4>
                <p>Una volta deployato su Vercel, potrai testare le API direttamente dal browser o con tools come Postman:</p>
                <ul style="margin: 1rem 0; padding-left: 2rem;">
                    <li><code>https://tuo-sito.vercel.app/api/books</code></li>
                    <li><code>https://tuo-sito.vercel.app/api/authors</code></li>
                    <li><code>https://tuo-sito.vercel.app/api/stats</code></li>
                </ul>
                <p style="font-size: 0.9rem; color: #666; margin-top: 1rem;">
                    Le API supportan CORS e restituiscono JSON puro, perfette per integrazioni esterne!
                </p>
            </div>

            <div id="apiOutput"></div>
        </div>

        <!-- STATS PAGE -->
        <div id="stats" class="page">
            <h2>Statistiche della Libreria</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">1,247</div>
                    <div>Libri Totali</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">89</div>
                    <div>Autori</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">23</div>
                    <div>Categorie</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">15,432</div>
                    <div>Utenti Registrati</div>
                </div>
            </div>
            
            <div class="api-section">
                <h3>Statistiche API</h3>
                <div class="api-endpoint" onclick="loadApiData('detailed-stats')">
                    GET /api/detailed-stats - Statistiche dettagliate
                </div>
                <div id="statsOutput"></div>
            </div>
        </div>

        <!-- CONTACT PAGE -->
        <div id="contact" class="page">
            <h2>Contattaci</h2>
            <div class="contact-form">
                <form onsubmit="submitContact(event)">
                    <div class="form-group">
                        <label for="name">Nome:</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" required>
                    </div>
                    <div class="form-group">
                        <label for="message">Messaggio:</label>
                        <textarea id="message" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn">Invia Messaggio</button>
                </form>
            </div>
            
            <div class="api-section">
                <h3>API Contatti</h3>
                <div class="api-endpoint" onclick="loadApiData('contact-info')">
                    GET /api/contact-info - Informazioni di contatto
                </div>
                <div id="contactOutput"></div>
            </div>
        </div>
    </main>

    <!-- Modal per dettagli libro -->
    <div id="bookModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <script>
        // Dati di fallback per quando le API non sono disponibili
        const fallbackData = {
            books: [
                { id: 1, title: "Il Nome della Rosa", author: "Umberto Eco", year: 1980, category: "Romanzo storico", pages: 624, isbn: "978-88-452-1111-1" },
                { id: 2, title: "1984", author: "George Orwell", year: 1949, category: "Distopia", pages: 328, isbn: "978-88-452-2222-2" },
                { id: 3, title: "Il Piccolo Principe", author: "Antoine de Saint-Exup√©ry", year: 1943, category: "Favola", pages: 96, isbn: "978-88-452-3333-3" },
                { id: 4, title: "Cent'anni di solitudine", author: "Gabriel Garc√≠a M√°rquez", year: 1967, category: "Realismo magico", pages: 417, isbn: "978-88-452-4444-4" },
                { id: 5, title: "Il Signore degli Anelli", author: "J.R.R. Tolkien", year: 1954, category: "Fantasy", pages: 1216, isbn: "978-88-452-5555-5" },
                { id: 6, title: "Orgoglio e Pregiudizio", author: "Jane Austen", year: 1813, category: "Romanzo", pages: 432, isbn: "978-88-452-6666-6" }
            ]
        };

        // Utility function per chiamate API
        async function apiCall(endpoint) {
            try {
                const response = await fetch(endpoint);
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                const result = await response.json();
                return result.success ? result.data : result;
            } catch (error) {
                console.error(`API Error for ${endpoint}:`, error);
                throw error;
            }
        }

        // Loading indicator
        function showLoading(container) {
            if (container) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #764ba2; border-radius: 50%; animation: spin 1s linear infinite;"></div>
                        <p style="margin-top: 1rem; color: #666;">Caricamento dati...</p>
                    </div>
                    <style>
                        @keyframes spin {
                            0% { transform: rotate(0deg); }
                            100% { transform: rotate(360deg); }
                        }
                    </style>
                `;
            }
        }

        function showPage(pageId) {
            // Nasconde tutte le pagine
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Rimuove la classe active da tutti i link di navigazione
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Mostra la pagina selezionata
            document.getElementById(pageId).classList.add('active');
            
            // Aggiunge la classe active al link corrispondente
            event.target.classList.add('active');
            
            // Carica i libri se siamo nella pagina books
            if (pageId === 'books') {
                loadAllBooks();
            }
        }

        function loadAllBooks() {
            const booksContainer = document.getElementById('allBooks');
            showLoading(booksContainer);
            
            // Prova a caricare dai API reali, fallback ai dati locali
            apiCall('/api/books')
                .then(books => {
                    renderBooks(books, booksContainer);
                })
                .catch(error => {
                    console.warn('API non disponibile, uso dati di fallback:', error);
                    renderBooks(fallbackData.books, booksContainer);
                });
        }

        function renderBooks(books, container) {
            container.innerHTML = '';
            
            books.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card';
                bookCard.onclick = () => openBookModal(book.title, book);
                
                const emoji = getBookEmoji(book.category);
                
                bookCard.innerHTML = `
                    <div class="book-image">${emoji} ${book.title}</div>
                    <div class="book-info">
                        <h3>${book.title}</h3>
                        <p>${book.author} - ${book.category} (${book.year})</p>
                        <p>Pagine: ${book.pages} | ISBN: ${book.isbn}</p>
                        ${book.rating ? `<p>‚≠ê ${book.rating}/5</p>` : ''}
                        ${book.available !== undefined ? `<p>üìö ${book.available ? 'Disponibile' : 'Non disponibile'}</p>` : ''}
                    </div>
                `;
                
                container.appendChild(bookCard);
            });
        }

        function getBookEmoji(category) {
            const emojis = {
                "Romanzo storico": "üè∞",
                "Distopia": "üëÅÔ∏è",
                "Favola": "üëë",
                "Realismo magico": "‚ú®",
                "Fantasy": "üßô‚Äç‚ôÇÔ∏è",
                "Romanzo": "üìñ"
            };
            return emojis[category] || "üìö";
        }

        function openBookModal(title, book = null) {
            const modal = document.getElementById('bookModal');
            const modalContent = document.getElementById('modalContent');
            
            if (book) {
                modalContent.innerHTML = `
                    <h2>${book.title}</h2>
                    <p><strong>Autore:</strong> ${book.author}</p>
                    <p><strong>Anno:</strong> ${book.year}</p>
                    <p><strong>Categoria:</strong> ${book.category}</p>
                    <p><strong>Pagine:</strong> ${book.pages}</p>
                    <p><strong>ISBN:</strong> ${book.isbn}</p>
                    ${book.rating ? `<p><strong>Valutazione:</strong> ‚≠ê ${book.rating}/5</p>` : ''}
                    ${book.available !== undefined ? `<p><strong>Disponibilit√†:</strong> ${book.available ? '‚úÖ Disponibile' : '‚ùå Non disponibile'}</p>` : ''}
                    ${book.description ? `<p><strong>Descrizione:</strong> ${book.description}</p>` : ''}
                    <div class="api-section">
                        <h4>Dati API per questo libro:</h4>
                        <div class="json-output">${JSON.stringify(book, null, 2)}</div>
                        <p style="margin-top: 1rem; font-size: 0.9rem; color: #666;">
                            <strong>URL API:</strong> <code>/api/books/${book.id}</code>
                        </p>
                    </div>
                `;
            } else {
                // Fallback per i libri della home
                const fallbackBook = fallbackData.books.find(b => b.title === title);
                if (fallbackBook) {
                    openBookModal(title, fallbackBook);
                    return;
                }
                modalContent.innerHTML = `<h2>${title}</h2><p>Dettagli non disponibili</p>`;
            }
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('bookModal').style.display = 'none';
        }

        async function loadApiData(endpoint, id = null) {
            let apiUrl;
            let outputContainer = getOutputContainer();
            
            // Mostra loading
            showLoading(outputContainer);
            
            try {
                switch(endpoint) {
                    case 'books':
                        apiUrl = '/api/books';
                        break;
                    case 'book':
                        apiUrl = `/api/books/${id}`;
                        break;
                    case 'authors':
                        apiUrl = '/api/authors';
                        break;
                    case 'author':
                        apiUrl = `/api/authors/${id}`;
                        break;
                    case 'categories':
                        apiUrl = '/api/categories';
                        break;
                    case 'stats':
                        apiUrl = '/api/stats';
                        break;
                    case 'detailed-stats':
                        apiUrl = '/api/detailed-stats';
                        break;
                    case 'contact-info':
                        apiUrl = '/api/contact-info';
                        break;
                    default:
                        throw new Error(`Endpoint non riconosciuto: ${endpoint}`);
                }

                // Chiamata API reale
                const data = await apiCall(apiUrl);
                
                const output = `
                    <div class="api-section">
                        <h3>‚úÖ Risposta API per: ${apiUrl}</h3>
                        <p style="color: #28a745; font-size: 0.9rem; margin-bottom: 1rem;">
                            <strong>Status:</strong> Success | <strong>Endpoint:</strong> <code>${apiUrl}</code>
                        </p>
                        <div class="json-output">${JSON.stringify(data, null, 2)}</div>
                        <div style="margin-top: 1rem; padding: 1rem; background: #e8f5e8; border-radius: 5px; font-size: 0.9rem;">
                            <strong>üîó Testa questo endpoint:</strong><br>
                            <code>${window.location.origin}${apiUrl}</code><br>
                            <small>Copia questo URL e aprilo in una nuova scheda per vedere i dati JSON puri!</small>
                        </div>
                    </div>
                `;
                
                if (outputContainer) {
                    outputContainer.innerHTML = output;
                }
                
            } catch (error) {
                console.error('Errore API:', error);
                
                const errorOutput = `
                    <div class="api-section">
                        <h3>‚ùå Errore API per: ${apiUrl}</h3>
                        <p style="color: #dc3545; font-size: 0.9rem; margin-bottom: 1rem;">
                            <strong>Errore:</strong> ${error.message}
                        </p>
                        <div style="background: #f8d7da; padding: 1rem; border-radius: 5px; border-left: 4px solid #dc3545;">
                            <strong>Possibili cause:</strong><br>
                            ‚Ä¢ API non ancora deployate su Vercel<br>
                            ‚Ä¢ Errore di rete<br>
                            ‚Ä¢ Endpoint non configurato correttamente<br><br>
                            <strong>Soluzione:</strong> Assicurati che i file API siano nella cartella <code>/api/</code> e che il sito sia deployato su Vercel.
                        </div>
                    </div>
                `;
                
                if (outputContainer) {
                    outputContainer.innerHTML = errorOutput;
                }
            }
        }

        function getOutputContainer() {
            const currentPage = document.querySelector('.page.active').id;
            let outputContainer = document.getElementById('apiOutput');
            
            if (currentPage === 'stats') {
                outputContainer = document.getElementById('statsOutput');
            } else if (currentPage === 'contact') {
                outputContainer = document.getElementById('contactOutput');
            }
            
            return outputContainer;
        }

        function submitContact(event) {
            event.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                message: document.getElementById('message').value,
                timestamp: new Date().toISOString()
            };
            
            alert('Messaggio inviato con successo!\n\nDati inviati:\n' + JSON.stringify(formData, null, 2));
            
            // Reset form
            event.target.reset();
        }

        // Chiudi modal cliccando fuori
        window.onclick = function(event) {
            const modal = document.getElementById('bookModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Inizializza la pagina
        document.addEventListener('DOMContentLoaded', function() {
            loadAllBooks();
        });
    </script>
	
	<script>
	  async function onTurnstileHomeSolved(token) {
		const msg = document.getElementById('homeVerifyMsg');
		try {
		  const res = await fetch('/api/turnstile-verify', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ 'cf-turnstile-response': token })
		  });
		  const data = await res.json();
		  console.log('verify:', res.status, data);

		  const ok = res.ok && data.success === true;
		  msg.textContent = ok
			? '‚úÖ Verifica completata'
			: `‚ùå Verifica fallita${data['error-codes'] ? ': ' + data['error-codes'].join(', ') : ''} (HTTP ${res.status})`;

		  if (!ok) window.turnstile?.reset(document.querySelector('.cf-turnstile'));
		} catch (e) {
		  msg.textContent = '‚ùå Errore di verifica (rete/JSON)';
		  console.error(e);
		}
	  }
	</script>

	
<!-- 	<script>
	  async function onTurnstileHomeSolved(token) {
		try {
		  const res = await fetch('/api/turnstile-verify', {
			method: 'POST',
			headers: { 'Content-Type': 'application/json' },
			body: JSON.stringify({ 'cf-turnstile-response': token })
		  });
		  const data = await res.json();

		  // Controllo anche action e hostname
		  const valid =
			res.ok &&
			data?.success === true &&
			data?.action === 'homepage' &&
			(data?.hostname === 'www.sectest-lab.space' || data?.hostname === 'sectest-lab.space');

		  const msg = document.getElementById('homeVerifyMsg');
		  msg.textContent = valid
			? '‚úÖ Verifica completata'
			: `‚ùå Verifica fallita${data['error-codes'] ? ': ' + data['error-codes'].join(', ') : ''}`;
		} catch (e) {
		  const msg = document.getElementById('homeVerifyMsg');
		  msg.textContent = '‚ùå Errore di verifica';
		}
	  }
</script> -->

</body>
</html>